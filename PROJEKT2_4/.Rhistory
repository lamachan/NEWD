group_by(side) %>%
summarise(count = n()) %>%
arrange(desc(count))
top10_sides <- head(side_counts, 10)
datainitA = data %>%
distinct(battle_id, sideA, initiatorA) %>%
filter(initiatorA == 1) %>%
filter(sideA != "")
colnames(datainitA)[2]<-"side"
init_counts <- datainitA %>%
group_by(side) %>%
summarise(count = n())
joined_top10 <- left_join(top10_sides, init_counts, by = "side")
colnames(joined_top10) <- c("commander", "battles", "initiations")
joined_top10$commander <- str_to_title(joined_top10$commander)
plot_data_long <- gather(joined_top10, key = "type", value = "count", -commander)
plot_data_long$commander <- factor(plot_data_long$commander, levels = plot_data_long$commander[order(plot_data_long$count[plot_data_long$type == "battles"])])
plot_data_long$type <- factor(plot_data_long$type, levels = c("initiations", "battles"))
legend_labels <- c("battles" = "bitwy", "initiations" = "inicjacje")
ggplot(plot_data_long, aes(x = commander, y = count, fill = type)) +
geom_bar(stat = "identity", position = "dodge", orientation = "horizontal") +
labs(title = "Top 10 dowódców według liczby bitew",
x = "Dowódca",
y = "Liczba",
fill = "Rodzaj") +
coord_flip() +
scale_fill_manual(values = c("battles" = "red", "initiations" = "lightgreen"), labels = legend_labels) +
theme_minimal() +
theme(legend.position = "top")
setwd("D:/DOKUMENTY/STUDIA/SEMESTR 6/NEWD/PROJEKT/NEWD/PROJEKT2_4")
library(plyr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
data<-read.csv("data/WarringStatesJapan_battledataV1.csv", encoding = "UTF-8")
# ------------------------------------------------------------------------------
# BITWY W LATACH 1467-1600
# ------------------------------------------------------------------------------
Figure1 <- data.frame(year = 1467:1600)
batyr <- data %>%
select(year, province) %>%
distinct() %>%
count(year)
colnames(batyr)[2] <- "battles"
Figure1 <- left_join(Figure1, batyr, by = "year")
Figure1[is.na(Figure1)] <- 0
ggplot(Figure1, aes(x = year, y = battles)) +
geom_line(color = "red", linewidth = 1) +
geom_point() +
labs(title = "Bitwy w latach 1467-1600",
x = "Rok",
y = "Liczba bitew") +
theme_minimal()
# ------------------------------------------------------------------------------
# ROZPRZESTRZENIANIE SIĘ KONFLIKTU W LATACH 1467-1600
# ------------------------------------------------------------------------------
provyeardata <- unique(data[c("year", "province")])
provyeardata <- subset(provyeardata, province != "")
provyeardata2 <- provyeardata %>%
group_by(year) %>%
summarise(`total number of provinces experiencing conflict` = n_distinct(province)) %>%
mutate(`percentage of provinces experiencing conflict` = `total number of provinces experiencing conflict` / 68)
Figure2 <- data.frame(year = 1467:1600)
Figure2 <- left_join(Figure2, provyeardata2, by = "year")
Figure2[is.na(Figure2)] <- 0
provyeardata3 <- provyeardata %>%
group_by(province) %>%
summarise(year = min(year)) %>%
ungroup()
newprovyeardata <- provyeardata3 %>%
count(year) %>%
rename(`new provinces experiencing battle` = n)
Figure2 <- left_join(Figure2, newprovyeardata, by = "year")
Figure2[is.na(Figure2)] <- 0
Figure2 <- Figure2 %>%
mutate(`total number of provinces that have experienced battle` = cumsum(`new provinces experiencing battle`))
ggplot(Figure2, aes(x = year)) +
geom_bar(aes(y = `total number of provinces that have experienced battle`), stat = "identity", fill = "yellow", alpha = 0.7) +
geom_line(aes(y = `percentage of provinces experiencing conflict` * 100, group = 1), color = "black", linewidth = 1) +
geom_point(aes(y = `percentage of provinces experiencing conflict` * 100), color = "black", linewidth = 2) +
scale_y_continuous(
name = "Sumaryczna liczba prowincji, która już była w konflikcie",
sec.axis = sec_axis(~., name = "Procent prowincji obecnie w konflikcie")
) +
labs(title = "Rozprzestrzenianie się konfliktu w latach 1467-1600",
x = "Rok") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 0.5),
)
# ------------------------------------------------------------------------------
# LICZBA BITEW W POSZCZEGÓLNYCH MIESIĄCACH
# ------------------------------------------------------------------------------
month_battle_counts <- data %>%
mutate(month = as.numeric(month)) %>%
distinct(month, battle_id) %>%
group_by(month) %>%
summarise(battles = n()) %>%
filter(!is.na(month))
ggplot(month_battle_counts, aes(x = factor(month, levels = 1:12), y = battles)) +
geom_bar(stat = "identity", fill = "red", color = "black") +
labs(title = "Liczba bitew w poszczególnych miesiącach",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
# ------------------------------------------------------------------------------
# LICZBA BITEW W POSZCZEGÓLNYCH MIESIĄCACH Z PODZIAŁEM NA REGIONY
# ------------------------------------------------------------------------------
province_month_battle_counts <- data %>%
mutate(month = as.numeric(month)) %>%
distinct(month, battle_id, province) %>%
mutate(region = case_when(
province %in% c("dewa", "mutsu", "echigo", "sado") ~ "north",
province %in% c("satsuma", "osumi", "hyuuga", "higo", "bungo", "chikugo", "hizen", "chikuzen", "buzen", "iki", "tsushima") ~ "south",
TRUE ~ NA_character_
)) %>%
group_by(month, region) %>%
summarise(count = n()) %>%
filter(!is.na(month) & !is.na(region))
north_data <- province_month_battle_counts %>%
filter(region == "north")
south_data <- province_month_battle_counts %>%
filter(region == "south")
north_plot <- ggplot(north_data, aes(x = factor(month), y = count)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
labs(title = "Bitwy w poszczególnych miesiącah - północ",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
south_plot <- ggplot(south_data, aes(x = factor(month), y = count)) +
geom_bar(stat = "identity", fill = "orange", color = "black") +
labs(title = "Bitwy w poszczególnych miesiącah - południe",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
gridExtra::grid.arrange(north_plot, south_plot, ncol = 2)
# ------------------------------------------------------------------------------
# TOP 10 DOWÓDCÓW WG LICZBY BITEW (I ICH INICJACJI)
# ------------------------------------------------------------------------------
datasideA = data %>%
distinct(battle_id, sideA)
colnames(datasideA)[2]<-"side"
datasideB = data %>%
distinct(battle_id, sideB)
colnames(datasideB)[2]<-"side"
datasideAB = rbind(datasideA, datasideB) %>%
distinct(battle_id, side) %>%
filter(side != "")
side_counts <- datasideAB %>%
group_by(side) %>%
summarise(count = n()) %>%
arrange(desc(count))
top10_sides <- head(side_counts, 10)
datainitA = data %>%
distinct(battle_id, sideA, initiatorA) %>%
filter(initiatorA == 1) %>%
filter(sideA != "")
colnames(datainitA)[2]<-"side"
init_counts <- datainitA %>%
group_by(side) %>%
summarise(count = n())
joined_top10 <- left_join(top10_sides, init_counts, by = "side")
colnames(joined_top10) <- c("commander", "battles", "initiations")
joined_top10$commander <- str_to_title(joined_top10$commander)
plot_data_long <- gather(joined_top10, key = "type", value = "count", -commander)
plot_data_long$commander <- factor(plot_data_long$commander, levels = plot_data_long$commander[order(plot_data_long$count[plot_data_long$type == "battles"])])
plot_data_long$type <- factor(plot_data_long$type, levels = c("initiations", "battles"))
legend_labels <- c("battles" = "bitwy", "initiations" = "inicjacje")
ggplot(plot_data_long, aes(x = commander, y = count, fill = type)) +
geom_bar(stat = "identity", position = "dodge", orientation = "horizontal") +
labs(title = "Top 10 dowódców według liczby bitew",
x = "Dowódca",
y = "Liczba",
fill = "Rodzaj") +
coord_flip() +
scale_fill_manual(values = c("battles" = "red", "initiations" = "lightgreen"), labels = legend_labels) +
theme_minimal() +
theme(legend.position = "top")
library(plyr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
data<-read.csv("data/WarringStatesJapan_battledataV1.csv", encoding = "UTF-8")
# ------------------------------------------------------------------------------
# BITWY W LATACH 1467-1600
# ------------------------------------------------------------------------------
Figure1 <- data.frame(year = 1467:1600)
batyr <- data %>%
select(year, province) %>%
distinct() %>%
count(year)
colnames(batyr)[2] <- "battles"
Figure1 <- left_join(Figure1, batyr, by = "year")
Figure1[is.na(Figure1)] <- 0
ggplot(Figure1, aes(x = year, y = battles)) +
geom_line(color = "red", linewidth = 1) +
geom_point(color = "red") +
labs(title = "Bitwy w latach 1467-1600",
x = "Rok",
y = "Liczba bitew") +
theme_minimal()
# ------------------------------------------------------------------------------
# ROZPRZESTRZENIANIE SIĘ KONFLIKTU W LATACH 1467-1600
# ------------------------------------------------------------------------------
provyeardata <- unique(data[c("year", "province")])
provyeardata <- subset(provyeardata, province != "")
provyeardata2 <- provyeardata %>%
group_by(year) %>%
summarise(`total number of provinces experiencing conflict` = n_distinct(province)) %>%
mutate(`percentage of provinces experiencing conflict` = `total number of provinces experiencing conflict` / 68)
Figure2 <- data.frame(year = 1467:1600)
Figure2 <- left_join(Figure2, provyeardata2, by = "year")
Figure2[is.na(Figure2)] <- 0
provyeardata3 <- provyeardata %>%
group_by(province) %>%
summarise(year = min(year)) %>%
ungroup()
newprovyeardata <- provyeardata3 %>%
count(year) %>%
rename(`new provinces experiencing battle` = n)
Figure2 <- left_join(Figure2, newprovyeardata, by = "year")
Figure2[is.na(Figure2)] <- 0
Figure2 <- Figure2 %>%
mutate(`total number of provinces that have experienced battle` = cumsum(`new provinces experiencing battle`))
ggplot(Figure2, aes(x = year)) +
geom_bar(aes(y = `total number of provinces that have experienced battle`), stat = "identity", fill = "violet", alpha = 0.7) +
geom_line(aes(y = `percentage of provinces experiencing conflict` * 100, group = 1), color = "black", linewidth = 1) +
geom_point(aes(y = `percentage of provinces experiencing conflict` * 100), color = "black", linewidth = 2) +
scale_y_continuous(
name = "Sumaryczna liczba prowincji, która już była w konflikcie",
sec.axis = sec_axis(~., name = "Procent prowincji obecnie w konflikcie")
) +
labs(title = "Rozprzestrzenianie się konfliktu w latach 1467-1600",
x = "Rok") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 0.5),
)
# ------------------------------------------------------------------------------
# LICZBA BITEW W POSZCZEGÓLNYCH MIESIĄCACH
# ------------------------------------------------------------------------------
month_battle_counts <- data %>%
mutate(month = as.numeric(month)) %>%
distinct(month, battle_id) %>%
group_by(month) %>%
summarise(battles = n()) %>%
filter(!is.na(month))
ggplot(month_battle_counts, aes(x = factor(month, levels = 1:12), y = battles)) +
geom_bar(stat = "identity", fill = "red", color = "black") +
labs(title = "Liczba bitew w poszczególnych miesiącach",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
# ------------------------------------------------------------------------------
# LICZBA BITEW W POSZCZEGÓLNYCH MIESIĄCACH Z PODZIAŁEM NA REGIONY
# ------------------------------------------------------------------------------
province_month_battle_counts <- data %>%
mutate(month = as.numeric(month)) %>%
distinct(month, battle_id, province) %>%
mutate(region = case_when(
province %in% c("dewa", "mutsu", "echigo", "sado") ~ "north",
province %in% c("satsuma", "osumi", "hyuuga", "higo", "bungo", "chikugo", "hizen", "chikuzen", "buzen", "iki", "tsushima") ~ "south",
TRUE ~ NA_character_
)) %>%
group_by(month, region) %>%
summarise(count = n()) %>%
filter(!is.na(month) & !is.na(region))
north_data <- province_month_battle_counts %>%
filter(region == "north")
south_data <- province_month_battle_counts %>%
filter(region == "south")
north_plot <- ggplot(north_data, aes(x = factor(month), y = count)) +
geom_bar(stat = "identity", fill = "skyblue", color = "black") +
labs(title = "Bitwy w poszczególnych miesiącah - północ",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
south_plot <- ggplot(south_data, aes(x = factor(month), y = count)) +
geom_bar(stat = "identity", fill = "orange", color = "black") +
labs(title = "Bitwy w poszczególnych miesiącah - południe",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
gridExtra::grid.arrange(north_plot, south_plot, ncol = 2)
# ------------------------------------------------------------------------------
# TOP 10 DOWÓDCÓW WG LICZBY BITEW (I ICH INICJACJI)
# ------------------------------------------------------------------------------
datasideA = data %>%
distinct(battle_id, sideA)
colnames(datasideA)[2]<-"side"
datasideB = data %>%
distinct(battle_id, sideB)
colnames(datasideB)[2]<-"side"
datasideAB = rbind(datasideA, datasideB) %>%
distinct(battle_id, side) %>%
filter(side != "")
side_counts <- datasideAB %>%
group_by(side) %>%
summarise(count = n()) %>%
arrange(desc(count))
top10_sides <- head(side_counts, 10)
datainitA = data %>%
distinct(battle_id, sideA, initiatorA) %>%
filter(initiatorA == 1) %>%
filter(sideA != "")
colnames(datainitA)[2]<-"side"
init_counts <- datainitA %>%
group_by(side) %>%
summarise(count = n())
joined_top10 <- left_join(top10_sides, init_counts, by = "side")
colnames(joined_top10) <- c("commander", "battles", "initiations")
joined_top10$commander <- str_to_title(joined_top10$commander)
plot_data_long <- gather(joined_top10, key = "type", value = "count", -commander)
plot_data_long$commander <- factor(plot_data_long$commander, levels = plot_data_long$commander[order(plot_data_long$count[plot_data_long$type == "battles"])])
plot_data_long$type <- factor(plot_data_long$type, levels = c("initiations", "battles"))
legend_labels <- c("battles" = "bitwy", "initiations" = "inicjacje")
ggplot(plot_data_long, aes(x = commander, y = count, fill = type)) +
geom_bar(stat = "identity", position = "dodge", orientation = "horizontal") +
labs(title = "Top 10 dowódców według liczby bitew",
x = "Dowódca",
y = "Liczba",
fill = "Rodzaj") +
coord_flip() +
scale_fill_manual(values = c("battles" = "red", "initiations" = "lightgreen"), labels = legend_labels) +
theme_minimal() +
theme(legend.position = "top")
library(plyr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
data<-read.csv("data/WarringStatesJapan_battledataV1.csv", encoding = "UTF-8")
# ------------------------------------------------------------------------------
# BITWY W LATACH 1467-1600
# ------------------------------------------------------------------------------
Figure1 <- data.frame(year = 1467:1600)
batyr <- data %>%
select(year, province) %>%
distinct() %>%
count(year)
colnames(batyr)[2] <- "battles"
Figure1 <- left_join(Figure1, batyr, by = "year")
Figure1[is.na(Figure1)] <- 0
ggplot(Figure1, aes(x = year, y = battles)) +
geom_line(color = "red", linewidth = 1) +
geom_point(color = "red") +
labs(title = "Bitwy w latach 1467-1600",
x = "Rok",
y = "Liczba bitew") +
theme_minimal()
# ------------------------------------------------------------------------------
# ROZPRZESTRZENIANIE SIĘ KONFLIKTU W LATACH 1467-1600
# ------------------------------------------------------------------------------
provyeardata <- unique(data[c("year", "province")])
provyeardata <- subset(provyeardata, province != "")
provyeardata2 <- provyeardata %>%
group_by(year) %>%
summarise(`total number of provinces experiencing conflict` = n_distinct(province)) %>%
mutate(`percentage of provinces experiencing conflict` = `total number of provinces experiencing conflict` / 68)
Figure2 <- data.frame(year = 1467:1600)
Figure2 <- left_join(Figure2, provyeardata2, by = "year")
Figure2[is.na(Figure2)] <- 0
provyeardata3 <- provyeardata %>%
group_by(province) %>%
summarise(year = min(year)) %>%
ungroup()
newprovyeardata <- provyeardata3 %>%
count(year) %>%
rename(`new provinces experiencing battle` = n)
Figure2 <- left_join(Figure2, newprovyeardata, by = "year")
Figure2[is.na(Figure2)] <- 0
Figure2 <- Figure2 %>%
mutate(`total number of provinces that have experienced battle` = cumsum(`new provinces experiencing battle`))
ggplot(Figure2, aes(x = year)) +
geom_bar(aes(y = `total number of provinces that have experienced battle`), stat = "identity", fill = "skyblue", alpha = 0.7) +
geom_line(aes(y = `percentage of provinces experiencing conflict` * 100, group = 1), color = "black", linewidth = 1) +
geom_point(aes(y = `percentage of provinces experiencing conflict` * 100), color = "black", linewidth = 2) +
scale_y_continuous(
name = "Sumaryczna liczba prowincji, która już była w konflikcie",
sec.axis = sec_axis(~., name = "Procent prowincji obecnie w konflikcie")
) +
labs(title = "Rozprzestrzenianie się konfliktu w latach 1467-1600",
x = "Rok") +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 90, hjust = 0.5),
)
# ------------------------------------------------------------------------------
# LICZBA BITEW W POSZCZEGÓLNYCH MIESIĄCACH
# ------------------------------------------------------------------------------
month_battle_counts <- data %>%
mutate(month = as.numeric(month)) %>%
distinct(month, battle_id) %>%
group_by(month) %>%
summarise(battles = n()) %>%
filter(!is.na(month))
ggplot(month_battle_counts, aes(x = factor(month, levels = 1:12), y = battles)) +
geom_bar(stat = "identity", fill = "red", color = "black") +
labs(title = "Liczba bitew w poszczególnych miesiącach",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
# ------------------------------------------------------------------------------
# LICZBA BITEW W POSZCZEGÓLNYCH MIESIĄCACH Z PODZIAŁEM NA REGIONY
# ------------------------------------------------------------------------------
province_month_battle_counts <- data %>%
mutate(month = as.numeric(month)) %>%
distinct(month, battle_id, province) %>%
mutate(region = case_when(
province %in% c("dewa", "mutsu", "echigo", "sado") ~ "north",
province %in% c("satsuma", "osumi", "hyuuga", "higo", "bungo", "chikugo", "hizen", "chikuzen", "buzen", "iki", "tsushima") ~ "south",
TRUE ~ NA_character_
)) %>%
group_by(month, region) %>%
summarise(count = n()) %>%
filter(!is.na(month) & !is.na(region))
north_data <- province_month_battle_counts %>%
filter(region == "north")
south_data <- province_month_battle_counts %>%
filter(region == "south")
north_plot <- ggplot(north_data, aes(x = factor(month), y = count)) +
geom_bar(stat = "identity", fill = "navy", color = "black") +
labs(title = "Bitwy w poszczególnych miesiącah - północ",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
south_plot <- ggplot(south_data, aes(x = factor(month), y = count)) +
geom_bar(stat = "identity", fill = "orange", color = "black") +
labs(title = "Bitwy w poszczególnych miesiącah - południe",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
gridExtra::grid.arrange(north_plot, south_plot, ncol = 2)
# ------------------------------------------------------------------------------
# TOP 10 DOWÓDCÓW WG LICZBY BITEW (I ICH INICJACJI)
# ------------------------------------------------------------------------------
datasideA = data %>%
distinct(battle_id, sideA)
colnames(datasideA)[2]<-"side"
datasideB = data %>%
distinct(battle_id, sideB)
colnames(datasideB)[2]<-"side"
datasideAB = rbind(datasideA, datasideB) %>%
distinct(battle_id, side) %>%
filter(side != "")
side_counts <- datasideAB %>%
group_by(side) %>%
summarise(count = n()) %>%
arrange(desc(count))
top10_sides <- head(side_counts, 10)
datainitA = data %>%
distinct(battle_id, sideA, initiatorA) %>%
filter(initiatorA == 1) %>%
filter(sideA != "")
colnames(datainitA)[2]<-"side"
init_counts <- datainitA %>%
group_by(side) %>%
summarise(count = n())
joined_top10 <- left_join(top10_sides, init_counts, by = "side")
colnames(joined_top10) <- c("commander", "battles", "initiations")
joined_top10$commander <- str_to_title(joined_top10$commander)
plot_data_long <- gather(joined_top10, key = "type", value = "count", -commander)
plot_data_long$commander <- factor(plot_data_long$commander, levels = plot_data_long$commander[order(plot_data_long$count[plot_data_long$type == "battles"])])
plot_data_long$type <- factor(plot_data_long$type, levels = c("initiations", "battles"))
legend_labels <- c("battles" = "bitwy", "initiations" = "inicjacje")
ggplot(plot_data_long, aes(x = commander, y = count, fill = type)) +
geom_bar(stat = "identity", position = "dodge", orientation = "horizontal") +
labs(title = "Top 10 dowódców według liczby bitew",
x = "Dowódca",
y = "Liczba",
fill = "Rodzaj") +
coord_flip() +
scale_fill_manual(values = c("battles" = "red", "initiations" = "lightgreen"), labels = legend_labels) +
theme_minimal() +
theme(legend.position = "top")
setwd("D:/DOKUMENTY/STUDIA/SEMESTR 6/NEWD/PROJEKT/NEWD/PROJEKT2_4")
library(plyr)
library(ggplot2)
library(dplyr)
library(tidyr)
library(stringr)
data<-read.csv("data/WarringStatesJapan_battledataV1.csv", encoding = "UTF-8")
province_month_battle_counts <- data %>%
mutate(month = as.numeric(month)) %>%
distinct(month, battle_id, province) %>%
mutate(region = case_when(
province %in% c("dewa", "mutsu", "echigo", "sado") ~ "north",
province %in% c("satsuma", "osumi", "hyuuga", "higo", "bungo", "chikugo", "hizen", "chikuzen", "buzen", "iki", "tsushima") ~ "south",
TRUE ~ NA_character_
)) %>%
group_by(month, region) %>%
summarise(count = n()) %>%
filter(!is.na(month) & !is.na(region))
north_data <- province_month_battle_counts %>%
filter(region == "north")
south_data <- province_month_battle_counts %>%
filter(region == "south")
north_plot <- ggplot(north_data, aes(x = factor(month), y = count)) +
geom_bar(stat = "identity", fill = "navy", color = "black") +
labs(title = "Bitwy w poszczególnych miesiącach - północ",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
south_plot <- ggplot(south_data, aes(x = factor(month), y = count)) +
geom_bar(stat = "identity", fill = "orange", color = "black") +
labs(title = "Bitwy w poszczególnych miesiącach - południe",
x = "Miesiąc",
y = "Liczba bitew") +
theme_minimal()
gridExtra::grid.arrange(north_plot, south_plot, ncol = 2)
